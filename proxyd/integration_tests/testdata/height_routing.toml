ws_method_whitelist = ["eth_subscribe", "eth_chainId", "eth_unsubscribe"]
ws_backend_group = "main"

[backends]
[backends.primary]
rpc_url = "$PRIMARY_BACKEND_RPC_URL"
ws_url = "$PRIMARY_BACKEND_RPC_URL"
username = ""
password = ""
max_rps = 3
max_ws_conns = 1

[backends.fallback]
rpc_url = "$FALLBACK_BACKEND_RPC_URL"
ws_url = "$FALLBACK_BACKEND_RPC_URL"
username = ""
password = ""
max_rps = 3
max_ws_conns = 1

[server]
rpc_host = "127.0.0.1"
rpc_port = 8545
ws_host = "127.0.0.1"
ws_port = 0
max_body_size_bytes = 10485760
max_concurrent_rpcs = 1000
log_level = "debug"

[metrics]
enabled = true
host = "127.0.0.1"
port = 9761

[backend_groups]
[backend_groups.main]
backends = ["primary", "fallback"]

[backend_groups.main.height_based_routing]
enabled = true
cutoff_height = 5000
primary_backend = "primary"
fallback_backend = "fallback"

# Custom method block parameter index configuration
[backend_groups.main.height_based_routing.method_config]
custom_getDataAtBlock = 1 # second parameter is block number
custom_queryByHeight = 0  # first parameter is block number
eth_getBalance_custom = 2 # custom method, third parameter is block number

[rpc_method_mappings]
eth_blockNumber = "main"
eth_getBlockByNumber = "main"
eth_getBlockByHash = "main"
eth_getBalance = "main"
eth_getTransactionByHash = "main"
eth_getTransactionReceipt = "main"
eth_getLogs = "main"
eth_newFilter = "main"
eth_call = "main"
eth_getBlockRange = "main"
# Custom methods
custom_getDataAtBlock = "main"
custom_queryByHeight = "main"
eth_getBalance_custom = "main"
